<?xml version="1.0" encoding="UTF-8"?>
<flow id="605a8335-51fb-40fe-8fe2-e61f71641eb7">
  <descriptionCdata><![CDATA[605a8335-51fb-40fe-8fe2-e61f71641eb7.56fb4157-78e1-4fdf-8d5f-edb0772726b2.description=<pre>\nThis operation creates an Azure AD account with an Exchange Online MailBox.\n* Note\: the user should be licensed, otherwise he will be disabled after 15 minutes.\n\n\nInputs\:\n    mailboxAlias - The mailbox alias.\n    accountName - The new user account name (This value should be unique).\n    accountPassword - The new user's password.\n    firstName - The new user's first name.\n    lastName - The new user's surname.\n    keepSessionAlive - If true, the operation will not close the PowerShell runspace (i.e. the PSSession in case of remote connections ) created during the execution and returns the runspaceID as the result of the operation. Actually the PowerShell runspace is saved in the OO session and can be used in other operations using the runspaceID result of previous operation.\nDefault value\: false\n    runspaceID - If not empty, the operation will search the OO session for keys which equal the runspaceID. If the operation finds the runspace specified by the runspaceID it tries to use it and does not create another PowerShell runspace with provided inputs. If the runspace exists but is broken or unavailable the operation uses its authentication parameters and tries to reconnect and recreate the PowerShell runspace. Please note that the operation will use the connection parameters of the runspace identified by runspaceID, not the values provided as user inputs. The operation will take into consideration the connection inputs (i.e. host, username, password, authType, useSSL, etc.) provided by user only if the runspaceID does not exist in the OO session.\n    script - The script to execute on the PowerShell host. If you want to execute a script from file just provide the file path.\nExample\:c\:\\PowerShellScripts\\GetHost.ps1\n\n\nResults\:\n    returnResult - The result of the script execution formatted as table or string depending on the returnTable input value as described above. In case of operation failure and "hideResults" is set to true, then this output will no longer contain the powershell exception stacktrace details.\n    script - The actual PowerShell script that was run. This result might be useful when piping is enabled or you want to know exactly the script that was sent to be run on the PowerShell host. Please note that the operation adds "Out-String" command to the end of your script if returnTable input is set to false. This output will be hidden if "hideResults" input is set to true.\n    objectsCount - The number of the PowerShell objects resulted from script execution (e.g. Get-Service will return the number of services found on the target host). This input is relevant only when returnTable is set to true. Otherwise, the value of this result will always be one, because the script returns a string message.\n    warnings - A list of warnings that the cmdlets emit. If the cmdlets were executed without warnings, then this result will be an empty string. This output will be hidden if "hideResults" input is set to true.\n    runspaceID - The runspace ID of the PowerShell runspace created during the execution of the operation.\n    stdout - The result of the commands that succeeded in case the operation fails. In case of operation failure this output will be hidden if "hideResults" input is set to true.\n\nResponses\:\n    success - The Powershell script or cmdlet was executed successfully.\n    failure - The command could not be executed.\n\n Note\: Certain special characters are not allowed. This includes the accountPassword field\n\n</pre>\n
]]></descriptionCdata>
  <annotation></annotation>
  <name>Create AD domain user</name>
  <categories/>
  <inputs/>
  <possibleResponses>
    <opResponse id="cc43bb1a-a488-4d85-8484-6a334d05c7d4">
      <annotation></annotation>
      <name>failure</name>
      <isDefault>false</isDefault>
      <onFailure>true</onFailure>
      <type>ERROR</type>
      <matchRules/>
    </opResponse>
    <opResponse id="4a0e39e5-147f-4e53-8aae-5e96999a505c">
      <annotation></annotation>
      <name>success</name>
      <isDefault>true</isDefault>
      <onFailure>false</onFailure>
      <type>RESOLVED</type>
      <matchRules/>
    </opResponse>
  </possibleResponses>
  <availableResultExpressions/>
  <resultExpression id="d481f64b-b9d7-4496-bbe8-44828d221868">
    <annotation></annotation>
    <name>FailureMessage</name>
    <fieldName>FailureMessage</fieldName>
    <sourceType>RAWRESULT</sourceType>
    <filters/>
  </resultExpression>
  <iconSpec id="61324a79-b282-4d79-b882-99be9eb74b27">
    <baseIcon>flow.png</baseIcon>
    <basePath>System</basePath>
    <readOnly>false</readOnly>
    <layers/>
  </iconSpec>
  <callouts/>
  <checkPointFlow>true</checkPointFlow>
  <compatibleRuntimeContext>false</compatibleRuntimeContext>
  <historyCheckPointFlow>true</historyCheckPointFlow>
  <steps>
    <step id="56fb4157-78e1-4fdf-8d5f-edb0772726b2">
      <annotation>605a8335-51fb-40fe-8fe2-e61f71641eb7.56fb4157-78e1-4fdf-8d5f-edb0772726b2.description</annotation>
      <name>Create User with Mailbox</name>
      <bounds>
        <x>75.0</x>
        <y>55.0</y>
      </bounds>
      <layer>-1</layer>
      <hideInbound>false</hideInbound>
      <addResultToRunContext>false</addResultToRunContext>
      <isCriticalStep>false</isCriticalStep>
      <isNonBlocking>false</isNonBlocking>
      <isParallelStep>false</isParallelStep>
      <isSingleResponse>false</isSingleResponse>
      <recordInHistory>false</recordInHistory>
      <recordRawOutput>true</recordRawOutput>
      <recordPrimaryOutput>true</recordPrimaryOutput>
      <checkPointStep>true</checkPointStep>
      <historyCheckPointStep>true</historyCheckPointStep>
      <scriptResultStep>false</scriptResultStep>
      <userPrompt></userPrompt>
      <bindings>
        <userInputBinding id="adfb779d-411a-4509-81c2-9b05258f7172">
          <annotation></annotation>
          <assignFromContext>false</assignFromContext>
          <assignToContext>false</assignToContext>
          <inputType>STRING</inputType>
          <isList>false</isList>
          <required>true</required>
          <isPersisted>true</isPersisted>
          <inputSymbol>accountName</inputSymbol>
          <listDelimiter>,</listDelimiter>
          <record>false</record>
          <validationFormat>
            <refId>1ab71378-77a1-48ca-bb23-28c17c3df53d</refId>
            <refName>command injection</refName>
          </validationFormat>
          <prompt></prompt>
          <isMultiSelect>false</isMultiSelect>
          <sourceDelimiter>|</sourceDelimiter>
        </userInputBinding>
        <userInputBinding id="607d42ea-5f8f-40fc-9fe8-6c1aa88517a4">
          <annotation></annotation>
          <assignFromContext>false</assignFromContext>
          <assignToContext>false</assignToContext>
          <inputType>STRING</inputType>
          <isList>false</isList>
          <required>true</required>
          <isPersisted>true</isPersisted>
          <inputSymbol>firstName</inputSymbol>
          <listDelimiter>,</listDelimiter>
          <record>false</record>
          <validationFormat>
            <refId>1ab71378-77a1-48ca-bb23-28c17c3df53d</refId>
            <refName>command injection</refName>
          </validationFormat>
          <prompt></prompt>
          <isMultiSelect>false</isMultiSelect>
          <sourceDelimiter>|</sourceDelimiter>
        </userInputBinding>
        <userInputBinding id="e582bf65-6e23-45f0-9c8d-d45735136bb9">
          <annotation></annotation>
          <assignFromContext>false</assignFromContext>
          <assignToContext>false</assignToContext>
          <inputType>STRING</inputType>
          <isList>false</isList>
          <required>true</required>
          <isPersisted>true</isPersisted>
          <inputSymbol>lastName</inputSymbol>
          <listDelimiter>,</listDelimiter>
          <record>false</record>
          <validationFormat>
            <refId>1ab71378-77a1-48ca-bb23-28c17c3df53d</refId>
            <refName>command injection</refName>
          </validationFormat>
          <prompt></prompt>
          <isMultiSelect>false</isMultiSelect>
          <sourceDelimiter>|</sourceDelimiter>
        </userInputBinding>
        <userInputBinding id="9ad77eda-0c2b-497d-ae19-a01e8f2eb94f">
          <annotation></annotation>
          <assignFromContext>false</assignFromContext>
          <assignToContext>false</assignToContext>
          <inputType>STRING</inputType>
          <isList>false</isList>
          <required>true</required>
          <isPersisted>true</isPersisted>
          <inputSymbol>mailboxAlias</inputSymbol>
          <listDelimiter>,</listDelimiter>
          <record>false</record>
          <validationFormat>
            <refId>1ab71378-77a1-48ca-bb23-28c17c3df53d</refId>
            <refName>command injection</refName>
          </validationFormat>
          <prompt></prompt>
          <isMultiSelect>false</isMultiSelect>
          <sourceDelimiter>|</sourceDelimiter>
        </userInputBinding>
        <userInputBinding id="e97b44f7-b644-4a56-859c-807166b3eea6">
          <annotation></annotation>
          <assignFromContext>false</assignFromContext>
          <assignToContext>false</assignToContext>
          <inputType>STRING</inputType>
          <isList>false</isList>
          <required>true</required>
          <isPersisted>true</isPersisted>
          <inputSymbol>userPrincipalName</inputSymbol>
          <listDelimiter>,</listDelimiter>
          <record>false</record>
          <validationFormat>
            <refId>1ab71378-77a1-48ca-bb23-28c17c3df53d</refId>
            <refName>command injection</refName>
          </validationFormat>
          <prompt></prompt>
          <isMultiSelect>false</isMultiSelect>
          <sourceDelimiter>|</sourceDelimiter>
        </userInputBinding>
        <userInputBinding id="edcb82ab-d9e3-4b60-b86b-faa20b56cf98">
          <annotation></annotation>
          <assignFromContext>false</assignFromContext>
          <assignToContext>false</assignToContext>
          <inputType>ENCRYPTED</inputType>
          <isList>false</isList>
          <required>true</required>
          <isPersisted>true</isPersisted>
          <inputSymbol>accountPassword</inputSymbol>
          <listDelimiter>,</listDelimiter>
          <record>false</record>
          <validationFormat>
            <refId>1ab71378-77a1-48ca-bb23-28c17c3df53d</refId>
            <refName>command injection</refName>
          </validationFormat>
          <prompt></prompt>
          <isMultiSelect>false</isMultiSelect>
          <sourceDelimiter>|</sourceDelimiter>
        </userInputBinding>
        <userInputBinding id="162fca1f-6437-4321-852f-0d7cabb96869">
          <annotation></annotation>
          <assignFromContext>false</assignFromContext>
          <assignToContext>false</assignToContext>
          <inputType>STRING</inputType>
          <isList>false</isList>
          <required>false</required>
          <isPersisted>true</isPersisted>
          <inputSymbol>keepSessionAlive</inputSymbol>
          <listDelimiter>,</listDelimiter>
          <record>false</record>
          <prompt></prompt>
          <isMultiSelect>false</isMultiSelect>
          <link>
            <refId>96a1ed25-cdc9-4ff6-8fba-e9c044c5ca53</refId>
            <refName>Boolean - False Default</refName>
          </link>
          <sourceDelimiter>|</sourceDelimiter>
        </userInputBinding>
        <staticBinding id="643249ae-7bcc-4c62-a74d-2afd79186770">
          <annotation></annotation>
          <assignFromContext>false</assignFromContext>
          <assignToContext>false</assignToContext>
          <inputType>STRING</inputType>
          <isList>false</isList>
          <required>false</required>
          <isPersisted>true</isPersisted>
          <inputSymbol>runspaceID</inputSymbol>
          <listDelimiter>,</listDelimiter>
          <record>false</record>
        </staticBinding>
        <staticBinding id="d8f96e1b-9348-4ee5-8c97-8f9785b4d186">
          <annotation></annotation>
          <assignFromContext>false</assignFromContext>
          <assignToContext>false</assignToContext>
          <inputType>STRING</inputType>
          <isList>false</isList>
          <required>true</required>
          <isPersisted>true</isPersisted>
          <inputSymbol>script</inputSymbol>
          <listDelimiter>,</listDelimiter>
          <value>New-Mailbox -Alias ${mailboxAlias} -Name ${accountName} -FirstName ${firstName} -LastName ${lastName} -DisplayName &quot;${firstName} ${lastName}&quot; -MicrosoftOnlineServicesID ${userPrincipalName} -Password (ConvertTo-SecureString -String &apos;${accountPassword}&apos; -AsPlainText -Force) -ResetPasswordOnNextLogon $true</value>
          <record>false</record>
        </staticBinding>
      </bindings>
      <transitions>
        <transition id="f45f6f0d-4d09-46b1-9324-3051c6ccdfb9">
          <annotation></annotation>
          <name>success</name>
          <command>NEXT</command>
          <linkMode>false</linkMode>
          <responseSymbol>success</responseSymbol>
          <shouldHandoff>false</shouldHandoff>
          <transitionValue>0.0</transitionValue>
          <destination>
            <refId>31eb5b0f-74b5-4d14-86e3-4d7176b79ed7</refId>
          </destination>
          <source>
            <refId>56fb4157-78e1-4fdf-8d5f-edb0772726b2</refId>
          </source>
          <positions>
            <point>
              <x>125.0</x>
              <y>89.0</y>
            </point>
            <point>
              <x>337.0</x>
              <y>213.0</y>
            </point>
          </positions>
          <labelPosition>
            <x>333.0</x>
            <y>0.0</y>
          </labelPosition>
        </transition>
        <transition id="88384ec0-7d04-4fc7-9150-164cc34bb954">
          <annotation></annotation>
          <name>failure</name>
          <command>NEXT</command>
          <linkMode>false</linkMode>
          <responseSymbol>failure</responseSymbol>
          <shouldHandoff>false</shouldHandoff>
          <transitionValue>0.0</transitionValue>
          <destination>
            <refId>23f60fa9-0833-48b6-a53d-dea413b89cd2</refId>
          </destination>
          <source>
            <refId>56fb4157-78e1-4fdf-8d5f-edb0772726b2</refId>
          </source>
          <positions>
            <point>
              <x>125.0</x>
              <y>89.0</y>
            </point>
            <point>
              <x>209.0</x>
              <y>215.0</y>
            </point>
          </positions>
          <labelPosition>
            <x>333.0</x>
            <y>0.0</y>
          </labelPosition>
        </transition>
      </transitions>
      <properties/>
      <opRef>
        <refId>d629e035-3087-45c5-bd5c-73206790787b</refId>
      </opRef>
      <assignments/>
      <throttleSize>0</throttleSize>
    </step>
    <returnStep id="23f60fa9-0833-48b6-a53d-dea413b89cd2">
      <annotation></annotation>
      <name>Error : failure</name>
      <bounds>
        <x>81.0</x>
        <y>228.0</y>
      </bounds>
      <layer>-1</layer>
      <hideInbound>false</hideInbound>
      <addResultToRunContext>false</addResultToRunContext>
      <isCriticalStep>false</isCriticalStep>
      <isNonBlocking>false</isNonBlocking>
      <isParallelStep>false</isParallelStep>
      <isSingleResponse>false</isSingleResponse>
      <recordInHistory>false</recordInHistory>
      <recordRawOutput>true</recordRawOutput>
      <recordPrimaryOutput>true</recordPrimaryOutput>
      <checkPointStep>true</checkPointStep>
      <historyCheckPointStep>true</historyCheckPointStep>
      <scriptResultStep>false</scriptResultStep>
      <userPrompt></userPrompt>
      <bindings/>
      <transitions>
        <transition id="9ea07e6d-baaa-4c40-a5ba-d898c3924bc8">
          <annotation></annotation>
          <name>return</name>
          <command>NEXT</command>
          <linkMode>false</linkMode>
          <responseSymbol>failure</responseSymbol>
          <shouldHandoff>false</shouldHandoff>
          <transitionValue>0.0</transitionValue>
          <destination>
            <refId>23f60fa9-0833-48b6-a53d-dea413b89cd2</refId>
          </destination>
          <source>
            <refId>23f60fa9-0833-48b6-a53d-dea413b89cd2</refId>
          </source>
          <positions/>
        </transition>
      </transitions>
      <properties/>
      <returnStepType>ERROR</returnStepType>
      <assignments/>
    </returnStep>
    <returnStep id="31eb5b0f-74b5-4d14-86e3-4d7176b79ed7">
      <annotation></annotation>
      <name>Resolved : success</name>
      <bounds>
        <x>422.0</x>
        <y>52.0</y>
      </bounds>
      <layer>-1</layer>
      <hideInbound>false</hideInbound>
      <addResultToRunContext>false</addResultToRunContext>
      <isCriticalStep>false</isCriticalStep>
      <isNonBlocking>false</isNonBlocking>
      <isParallelStep>false</isParallelStep>
      <isSingleResponse>false</isSingleResponse>
      <recordInHistory>false</recordInHistory>
      <recordRawOutput>true</recordRawOutput>
      <recordPrimaryOutput>true</recordPrimaryOutput>
      <checkPointStep>true</checkPointStep>
      <historyCheckPointStep>true</historyCheckPointStep>
      <scriptResultStep>false</scriptResultStep>
      <userPrompt></userPrompt>
      <bindings/>
      <transitions>
        <transition id="c6579e52-9dff-4e41-9be1-a81d1a7d7964">
          <annotation></annotation>
          <name>return</name>
          <command>NEXT</command>
          <linkMode>false</linkMode>
          <responseSymbol>success</responseSymbol>
          <shouldHandoff>false</shouldHandoff>
          <transitionValue>0.0</transitionValue>
          <destination>
            <refId>31eb5b0f-74b5-4d14-86e3-4d7176b79ed7</refId>
          </destination>
          <source>
            <refId>31eb5b0f-74b5-4d14-86e3-4d7176b79ed7</refId>
          </source>
          <positions/>
        </transition>
      </transitions>
      <properties/>
      <returnStepType>RESOLVED</returnStepType>
      <assignments/>
    </returnStep>
  </steps>
  <startSteps>56fb4157-78e1-4fdf-8d5f-edb0772726b2</startSteps>
</flow>